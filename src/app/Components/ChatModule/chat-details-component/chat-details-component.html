<div class="chat-details-container">
  <!-- Chat Header -->
  <div class="chat-details-header">
    <div class="user-info">
      <div class="user-avatar-container">
        <img
          [src]="chatDetails?.imgurl"
          [alt]="chatDetails?.name"
          class="user-avatar"
        />
        <!-- <div class="online-indicator" [class.active]="chatUser.isOnline"></div> -->
      </div>
      <div class="user-details">
        <h3 class="user-name">{{ chatDetails?.name }}</h3>
        <!-- <span class="user-status" [class.online]="chatUser.isOnline"> -->
        <!-- {{ chatUser.status }} -->
        <!-- </span> -->
      </div>
    </div>
    <button class="back-button" (click)="goBack()">
      <i class="fas fa-arrow-right"></i>
    </button>
  </div>
  <!-- Chat Messages -->
  <div class="chat-messages-container">
    @for (message of chatDetails?.messages; track $index) { @if
    (message.applicationId === userId) {
    <!-- رسالتي أنا -->
    <div class="message-group client">
      <div class="message-content">
        <div class="message-bubble">
          {{ message.text }}
        </div>
        <div class="message-timestamp">
          {{ message.sentAt | date : "hh:mm a" }}
        </div>
      </div>
      <div class="message-avatar-container">
        <div class="role-badge client">
          <i class="fas fa-user"></i>
        </div>
      </div>
    </div>
    } @else {
    <!-- رسالة من الطرف التاني -->
    <div class="message-group technician">
      <div class="message-avatar-container">
        <div class="role-badge technician">
          <i class="fas fa-wrench"></i>
        </div>
      </div>
      <div class="message-content">
        <div class="message-bubble">
          {{ message.text }}
        </div>
        <div class="message-timestamp">
          {{ message.sentAt | date : "hh:mm a" }}
        </div>
      </div>
    </div>
    } }
  </div>

  @if (!true) {
  <!-- Chat Input -->
  <div class="chat-input-section">
    <div class="input-container">
      <button class="attachment-btn camera">
        <i class="fas fa-camera"></i>
      </button>
      <button class="attachment-btn file">
        <i class="fas fa-paperclip"></i>
      </button>
      <div class="message-input-wrapper">
        <input type="text" placeholder="اكتب رسالة..." class="message-input" />
        <button class="emoji-btn">
          <i class="fas fa-smile"></i>
        </button>
      </div>
      <button class="send-message-btn">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>
  } @else {
  <div class="chat-input-section locked">
    <div class="locked-message">
      <i class="fas fa-lock"></i>
      <span>تم إغلاق المحادثة، الطلب تم الانتهاء منه.</span>
    </div>
  </div>
  }
</div>
